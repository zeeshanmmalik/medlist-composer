%tr
  %td.dyno-action
    = image_tag 'drag.png', :class => 'drag-handle', :alt =>  'click and drag to rearrange'
  %td
    %p{data: {editable: true, type: 'text', inputclass: 'input-medium',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'generic_name'}}= drug.generic_name
    %p{data: {editable: true, type: 'text', inputclass: 'input-medium',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'strength'}}= drug.strength
    %p.bold{data: {editable: true, type: 'text', inputclass: 'input-medium',
                   resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
                   name: 'brand_name'}}= drug.brand_name.blank? ? '':"(#{drug.brand_name})"
  %td
    - if drug.instructions.blank?
      %p{data: {editable: true, type: 'text', inputclass: 'input-long',
                resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
                nested_2: 'instructions', nnid: "new", name: '_name'}}=''
    - else
      - drug.instructions.each do |ins|
        %p{data: {editable: true, type: 'text', inputclass: 'input-long',
                resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
                nested_2: 'instructions', nnid: "#{ins.id}", name: '_name'}}=ins.line
  %td
    %p{data: {editable: true, type: 'text', inputclass: 'input-medium',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'purpose'}}= drug.purpose
  %td
    %p{data: {editable: true, type: 'text', inputclass: 'input-short',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'am_check'}}= drug.am_check
    %p{data: {editable: true, type: 'text', inputclass: 'input-short',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'am_time'}}= drug.am_time
  %td
    %p{data: {editable: true, type: 'text', inputclass: 'input-short',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'noon_check'}}= drug.noon_check
    %p{data: {editable: true, type: 'text', inputclass: 'input-short',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'noon_time'}}= drug.noon_time
  %td
    %p{data: {editable: true, type: 'text', inputclass: 'input-short',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'supper_check'}}= drug.supper_check
    %p{data: {editable: true, type: 'text', inputclass: 'input-short',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'supper_time'}}= drug.supper_time
  %td
    %p{data: {editable: true, type: 'text', inputclass: 'input-short',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'bedtime_check'}}= drug.bedtime_check
    %p{data: {editable: true, type: 'text', inputclass: 'input-short',
              resource: 'prescription', nested: 'drugs', nid: "#{drug.id}",
              name: 'bedtime_time'}}= drug.bedtime_time
  %td.dyno-action
    = image_tag 'clone.png', :class => 'row-cloner', :alt => 'Clone Row'
  %td.dyno-action
    = image_tag 'remove.png', :class => 'row-remover', :alt => 'Remove Row' 
